<!DOCTYPE html>
<html>
<head>
    <title>Mapa Georreferenciado</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <style>
        #map { height: 600px; } 
    </style>
</head>
<body>
    <div id="map"></div>

    <script>
        // 1. Definição da projeção EPSG:4326
        var crs = L.CRS.EPSG4326;

        // 2. Mapa base OpenStreetMap
        var osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        });

        // 3. Criação do mapa e adição da camada base
        var map = L.map('map', {
            crs: crs,
            layers: [osm]
        }).setView([-19.011158, -46.601209], 15); // Ponto central inicial (será atualizado)

        // 5. Carregamento das coordenadas e criação da camada de imagem
        fetch('camadas/coordenadas.txt')
            .then(response => response.text())
            .then(coordsText => {
                const coords = coordsText.slice(1, -1).split(',').map(Number); // Extrair coordenadas do texto
                const bounds = L.latLngBounds(
                    [coords[1], coords[0]], // Sul, Oeste
                    [coords[3], coords[2]]  // Norte, Leste
                );

                L.imageOverlay('camadas/ortofoto.png', bounds).addTo(map);

                // 6. Cálculo do ponto central e atualização da visualização
                const centerLat = (coords[1] + coords[3]) / 2;
                const centerLng = (coords[0] + coords[2]) / 2;
                map.setView([centerLat, centerLng], map.getZoom());
            });
    </script>
</body>
</html>
